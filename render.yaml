services:
  - type: web
    name: frontend
    env: docker
    plan: free
    dockerfilePath: ./front-end/Dockerfile
    autoDeploy: true
    envVars:
      - key: REACT_APP_API_URL
        value: https://api.onrender.com

  - type: web
    name: api
    env: docker
    plan: free
    dockerfilePath: ./back-end/Dockerfile
    startCommand: './main'
    autoDeploy: true
    envVars:
      - key: MONGODB_URI
        value: "mongodb+srv://marcoames:${MONGO_PASS}@animecluster.amhc7lk.mongodb.net/?retryWrites=true&w=majority&appName=AnimeCluster"

  - type: worker
    name: fetcher
    env: docker
    plan: free
    dockerfilePath: ./back-end/Dockerfile
    startCommand: './main -fetch'
    autoDeploy: true
    envVars:
      - key: MONGODB_URI
        value: "mongodb+srv://marcoames:${MONGO_PASS}@animecluster.amhc7lk.mongodb.net/?retryWrites=true&w=majority&appName=AnimeCluster"
